(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let s=e.i(47167).default.env.NEXT_PUBLIC_API_URL||"https://smart-compliance-backend.onrender.com";async function t(e,t){let a=`${s}${e}`;try{let e=await fetch(a,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!e.ok){let s=await e.json().catch(()=>({detail:"Unknown error"}));throw Error(s.detail||`HTTP ${e.status}`)}return await e.json()}catch(e){throw console.error("API request failed:",e),e}}async function a(e,s){let a=new URLSearchParams({role:e,document_type:s});return t(`/api/match?${a}`)}async function l(e,s=20){let a=new URLSearchParams({keyword:e,limit:s.toString()});return t(`/api/search?${a}`)}async function r(){return t("/api/roles")}async function n(){return t("/api/document-types")}async function i(){return t("/api/regulations")}async function c(){return t("/api/audit-rules")}e.s(["getAuditRules",()=>c,"getDocumentTypes",()=>n,"getRegulations",()=>i,"getRoles",()=>r,"matchClauses",()=>a,"searchClauses",()=>l])},63209,e=>{"use strict";let s=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],63209)},31713,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(55436),l=e.i(78583),r=e.i(63209),n=e.i(54858);function i(){let[e,i]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[o,m]=(0,t.useState)(""),[u,x]=(0,t.useState)(""),[h,g]=(0,t.useState)([]),[f,p]=(0,t.useState)(!1),[y,b]=(0,t.useState)(""),[j,N]=(0,t.useState)(!1);(0,t.useEffect)(()=>{!async function(){try{let[e,s]=await Promise.all([(0,n.getRoles)(),(0,n.getDocumentTypes)()]);i(e),d(s),e.length>0&&m(e[0].role_name),s.length>0&&x(s[0].type_name)}catch(e){b("加载数据失败，请检查后端服务是否正常运行"),console.error(e)}}()},[]);let v=async()=>{if(!o||!u)return void b("请选择审核角色和单据类型");p(!0),b(""),N(!1);try{let e=await (0,n.matchClauses)(o,u);g(e.matched_clauses),N(!0)}catch(e){b(e instanceof Error?e.message:"查询失败")}finally{p(!1)}};return(0,s.jsx)("div",{className:"h-full p-8",children:(0,s.jsxs)("div",{className:"mx-auto max-w-4xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"条款匹配查询"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"选择审核角色和单据类型，系统将为您匹配相关的法规条款"})]}),(0,s.jsx)("div",{className:"rounded-lg border bg-white p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"审核角色"}),(0,s.jsxs)("select",{value:o,onChange:e=>m(e.target.value),className:"block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:f,children:[(0,s.jsx)("option",{value:"",children:"请选择角色"}),e.map(e=>(0,s.jsx)("option",{value:e.role_name,children:e.role_name},e.id))]}),o&&e.find(e=>e.role_name===o)?.responsibilities&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:e.find(e=>e.role_name===o)?.responsibilities})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"单据类型"}),(0,s.jsxs)("select",{value:u,onChange:e=>x(e.target.value),className:"block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:f,children:[(0,s.jsx)("option",{value:"",children:"请选择单据类型"}),c.map(e=>(0,s.jsx)("option",{value:e.type_name,children:e.type_name},e.id))]}),u&&c.find(e=>e.type_name===u)?.description&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:c.find(e=>e.type_name===u)?.description})]}),(0,s.jsx)("button",{onClick:v,disabled:f||!o||!u,className:"w-full rounded-lg bg-blue-600 px-4 py-3 font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"查询中..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Search,{className:"mr-2 h-5 w-5"}),"开始查询"]})})]})}),y&&(0,s.jsx)("div",{className:"mt-6 rounded-lg border border-red-200 bg-red-50 p-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(r.AlertCircle,{className:"h-5 w-5 text-red-600 mt-0.5 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"出错了"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-red-700",children:y})]})]})}),j&&(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"匹配结果"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["共 ",h.length," 条"]})]}),0===h.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-white p-12 text-center",children:[(0,s.jsx)(l.FileText,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"未找到匹配的条款"}),(0,s.jsx)("p",{className:"mt-2 text-gray-500",children:"请尝试选择其他审核角色或单据类型"})]}):(0,s.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,s.jsx)("div",{className:"rounded-lg border bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.regulation_title}),(0,s.jsx)("p",{className:"mt-1 text-sm font-medium text-blue-600",children:e.clause_number}),(0,s.jsx)("p",{className:"mt-3 text-gray-700 leading-relaxed",children:e.content}),(0,s.jsxs)("div",{className:"mt-4 flex items-center space-x-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5",children:["来源: ",e.source]}),(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-blue-700",children:["优先级: ",e.priority]})]})]})})},e.clause_id))})]})]})})}e.s(["default",()=>i])}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let s=e.i(47167).default.env.NEXT_PUBLIC_API_URL||"http://localhost:10000";async function t(e,t){let a=`${s}${e}`;try{let e=await fetch(a,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!e.ok){let s=await e.json().catch(()=>({detail:"Unknown error"}));throw Error(s.detail||`HTTP ${e.status}`)}return await e.json()}catch(e){throw console.error("API request failed:",e),e}}async function a(e,s){let a=new URLSearchParams({role:e,document_type:s});return t(`/api/match?${a}`)}async function l(e,s=20){let a=new URLSearchParams({keyword:e,limit:s.toString()});return t(`/api/search?${a}`)}async function r(){return t("/api/roles")}async function c(){return t("/api/document-types")}async function i(){return t("/api/regulations")}async function n(){return t("/api/audit-rules")}e.s(["getAuditRules",()=>n,"getDocumentTypes",()=>c,"getRegulations",()=>i,"getRoles",()=>r,"matchClauses",()=>a,"searchClauses",()=>l])},63209,e=>{"use strict";let s=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],63209)},69638,e=>{"use strict";let s=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],69638)},2288,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(10980),l=e.i(78583),r=e.i(75254);let c=(0,r.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),i=(0,r.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var n=e.i(69638),d=e.i(63209),o=e.i(54858);function m(){let[e,r]=(0,t.useState)([]),[m,x]=(0,t.useState)(!0),[u,h]=(0,t.useState)(!1),[p,f]=(0,t.useState)(null),[g,y]=(0,t.useState)(!1),[b,j]=(0,t.useState)(null),N=(0,t.useRef)(null);async function v(){try{let e=await (0,o.getRegulations)();r(e)}catch(e){console.error(e)}finally{x(!1)}}(0,t.useEffect)(()=>{v()},[]);let w=async()=>{if(b){h(!0),f(null);try{let e=new FormData;e.append("file",b);let s=await fetch("http://localhost:10000/api/regulations/upload",{method:"POST",body:e});if(!s.ok){let e=await s.json().catch(()=>({detail:"上传失败"}));throw Error(e.detail||"上传失败")}let t=await s.json();f({success:!0,message:`上传成功！已解析 ${t.clause_count} 条法规条款`}),await v(),setTimeout(()=>{y(!1),j(null),f(null)},3e3)}catch(e){f({success:!1,message:e instanceof Error?e.message:"上传失败"})}finally{h(!1)}}};return(0,s.jsx)("div",{className:"h-full overflow-y-auto p-8",children:(0,s.jsxs)("div",{className:"mx-auto max-w-4xl",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"法规文档库"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"浏览系统中所有法规文档及其条款数量"})]}),(0,s.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700",children:[(0,s.jsx)(c,{className:"mr-2 h-5 w-5"}),"上传法规"]})]}),m?(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"法规列表"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["共 ",e.length," 个法规"]})]}),(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,s.jsx)("div",{className:"rounded-lg border bg-white p-6 shadow-sm hover:shadow-md transition-shadow",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(a.BookOpen,{className:"mr-4 mt-1 h-8 w-8 flex-shrink-0 text-blue-600"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,s.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.FileText,{className:"mr-1 h-4 w-4"}),e.clause_count," 条款"]}),e.source_file&&(0,s.jsx)("div",{className:"text-xs text-gray-400",children:e.source_file.split("/").pop()})]})]}),(0,s.jsx)("button",{className:"ml-4 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"查看详情"})]})},e.id))})]}),g&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,s.jsxs)("div",{className:"w-full max-w-lg rounded-lg bg-white p-6 shadow-xl",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"上传法规文档"}),(0,s.jsx)("button",{onClick:()=>{y(!1),j(null),f(null)},className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(i,{className:"h-6 w-6"})})]}),(0,s.jsx)("p",{className:"mb-6 text-sm text-gray-600",children:"支持上传PDF和Word文档（.pdf, .docx, .doc），文件大小不超过10MB"}),(0,s.jsxs)("div",{onClick:()=>N.current?.click(),className:"mb-4 cursor-pointer rounded-lg border-2 border-dashed border-gray-300 p-8 text-center hover:border-blue-500 hover:bg-blue-50",children:[(0,s.jsx)(c,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium text-gray-900",children:"点击选择文件或拖拽文件到此处"}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"支持PDF、Word文档"})]}),(0,s.jsx)("input",{ref:N,type:"file",accept:".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:e=>{let s=e.target.files?.[0];if(s){if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"].includes(s.type)&&!s.name.endsWith(".pdf")&&!s.name.endsWith(".docx")&&!s.name.endsWith(".doc"))return void f({success:!1,message:"仅支持PDF和Word文档（.pdf, .docx, .doc）"});if(s.size>0xa00000)return void f({success:!1,message:"文件大小不能超过10MB"});j(s),f(null)}},className:"hidden"}),b&&(0,s.jsx)("div",{className:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.FileText,{className:"mr-3 h-8 w-8 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:b.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[(b.size/1024/1024).toFixed(2)," MB"]})]})]}),(0,s.jsx)("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(i,{className:"h-5 w-5"})})]})}),p&&(0,s.jsx)("div",{className:`mb-4 rounded-lg border p-4 ${p.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,s.jsxs)("div",{className:"flex items-start",children:[p.success?(0,s.jsx)(n.CheckCircle,{className:"h-5 w-5 text-green-600 mt-0.5 mr-3"}):(0,s.jsx)(d.AlertCircle,{className:"h-5 w-5 text-red-600 mt-0.5 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:`text-sm font-medium ${p.success?"text-green-800":"text-red-800"}`,children:p.success?"上传成功":"上传失败"}),(0,s.jsx)("p",{className:`mt-1 text-sm ${p.success?"text-green-700":"text-red-700"}`,children:p.message})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>{y(!1),j(null),f(null)},className:"rounded-lg border border-gray-300 px-4 py-2 font-medium text-gray-700 hover:bg-gray-50",disabled:u,children:"取消"}),(0,s.jsx)("button",{onClick:w,disabled:!b||u,className:"flex items-center rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"上传中..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{className:"mr-2 h-4 w-4"}),"开始上传"]})})]})]})})]})})}e.s(["default",()=>m],2288)}]);
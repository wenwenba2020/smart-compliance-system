(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let s=e.i(47167).default.env.NEXT_PUBLIC_API_URL||"https://smart-compliance-backend.onrender.com";async function t(e,t){let l=`${s}${e}`;try{let e=await fetch(l,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!e.ok){let s=await e.json().catch(()=>({detail:"Unknown error"}));throw Error(s.detail||`HTTP ${e.status}`)}return await e.json()}catch(e){throw console.error("API request failed:",e),e}}async function l(e,s){let l=new URLSearchParams({role:e,document_type:s});return t(`/api/match?${l}`)}async function a(e,s=20){let l=new URLSearchParams({keyword:e,limit:s.toString()});return t(`/api/search?${l}`)}async function r(){return t("/api/roles")}async function n(){return t("/api/document-types")}async function c(){return t("/api/regulations")}async function i(){return t("/api/audit-rules")}e.s(["getAuditRules",()=>i,"getDocumentTypes",()=>n,"getRegulations",()=>c,"getRoles",()=>r,"matchClauses",()=>l,"searchClauses",()=>a])},9330,e=>{"use strict";var s=e.i(43476),t=e.i(71645),l=e.i(75254);let a=(0,l.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),r=(0,l.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),n=(0,l.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var c=e.i(78583),i=e.i(54858);function d(){let[e,l]=(0,t.useState)([]),[d,x]=(0,t.useState)([]),[m,o]=(0,t.useState)(!0),[u,h]=(0,t.useState)(new Set);async function p(){try{var e;let s,t=await (0,i.getAuditRules)();l(t);let a=(e=t,s=new Map,e.forEach(e=>{let t=`${e.role.role_name}|${e.document_type.type_name}`;s.has(t)||s.set(t,{role:e.role.role_name,documentType:e.document_type.type_name,clauses:[]}),s.get(t).clauses.push({id:e.clause.id,clauseNumber:e.clause.clause_number,content:e.clause.content,regulationTitle:e.clause.regulation.title,source:e.source,priority:e.priority})}),Array.from(s.values()));x(a)}catch(e){console.error(e)}finally{o(!1)}}return(0,t.useEffect)(()=>{p()},[]),(0,s.jsx)("div",{className:"h-full overflow-y-auto p-8",children:(0,s.jsxs)("div",{className:"mx-auto max-w-6xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"审核规则管理"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"查看审核角色、单据类型与法规条款之间的关联关系"})]}),m?(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===d.length?(0,s.jsxs)("div",{className:"rounded-lg border bg-white p-12 text-center",children:[(0,s.jsx)(c.FileText,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"暂无审核规则"}),(0,s.jsx)("p",{className:"mt-2 text-gray-500",children:"请先添加审核规则"})]}):(0,s.jsx)("div",{className:"space-y-4",children:d.map((e,t)=>(0,s.jsxs)("div",{className:"rounded-lg border bg-white shadow-sm overflow-hidden",children:[(0,s.jsx)("button",{onClick:()=>{let e;(e=new Set(u)).has(t)?e.delete(t):e.add(t),h(e)},className:"w-full flex items-center justify-between p-6 hover:bg-gray-50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[u.has(t)?(0,s.jsx)(a,{className:"h-5 w-5 text-gray-400"}):(0,s.jsx)(r,{className:"h-5 w-5 text-gray-400"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[e.role," → ",e.documentType]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.clauses.length," 条相关法规条款"]})]})]})}),u.has(t)&&(0,s.jsxs)("div",{className:"border-t bg-gray-50 p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"关联关系图"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"flex flex-col items-center",children:(0,s.jsxs)("div",{className:"w-full rounded-lg border-2 border-blue-500 bg-blue-50 p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-blue-600 mb-1",children:"审核角色"}),(0,s.jsx)("div",{className:"text-sm font-bold text-blue-900",children:e.role})]})}),(0,s.jsx)("div",{className:"flex flex-col items-center",children:(0,s.jsxs)("div",{className:"w-full rounded-lg border-2 border-green-500 bg-green-50 p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-green-600 mb-1",children:"单据类型"}),(0,s.jsx)("div",{className:"text-sm font-bold text-green-900",children:e.documentType})]})}),(0,s.jsx)("div",{className:"flex flex-col items-center",children:(0,s.jsxs)("div",{className:"w-full rounded-lg border-2 border-purple-500 bg-purple-50 p-4 text-center",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-purple-600 mb-1",children:"相关条款"}),(0,s.jsxs)("div",{className:"text-sm font-bold text-purple-900",children:[e.clauses.length," 条"]})]})})]}),(0,s.jsx)("div",{className:"relative mt-4 mb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,s.jsx)("div",{className:"flex-1 h-0.5 bg-gradient-to-r from-blue-500 to-green-500"}),(0,s.jsx)(n,{className:"h-6 w-6 text-green-500"}),(0,s.jsx)("div",{className:"flex-1 h-0.5 bg-gradient-to-r from-green-500 to-purple-500"}),(0,s.jsx)(n,{className:"h-6 w-6 text-purple-500"}),(0,s.jsx)("div",{className:"w-16"})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"关联的法规条款"}),(0,s.jsx)("div",{className:"space-y-3",children:e.clauses.map((e,t)=>(0,s.jsx)("div",{className:"rounded-lg border border-purple-200 bg-white p-4",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)("span",{className:"inline-flex items-center rounded-full bg-purple-100 px-2.5 py-0.5 text-xs font-medium text-purple-700",children:t+1}),(0,s.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:e.regulationTitle})]}),(0,s.jsx)("p",{className:"text-sm font-medium text-blue-600 mb-2",children:e.clauseNumber}),(0,s.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.content.length>150?e.content.substring(0,150)+"...":e.content}),(0,s.jsxs)("div",{className:"mt-3 flex items-center space-x-3 text-xs text-gray-500",children:[(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5",children:["来源: ",e.source]}),(0,s.jsxs)("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2 py-0.5 text-blue-700",children:["优先级: ",e.priority]})]})]})})},t))})]})]})]},t))}),!m&&d.length>0&&(0,s.jsxs)("div",{className:"mt-8 rounded-lg border bg-blue-50 p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"统计信息"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:d.length}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"审核规则组"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-green-600",children:e.length}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"条款关联"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:new Set(e.map(e=>e.role.role_name)).size}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"审核角色"})]})]})]})]})})}e.s(["default",()=>d],9330)}]);